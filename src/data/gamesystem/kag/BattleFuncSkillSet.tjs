//=============================
//¡ƒoƒgƒ‹ƒV[ƒ“—pŠeíŠÖ”
//=============================
// battleFuncs‚©‚çƒAƒNƒZƒX
//kag.fore.message[n].font.mapPrerenderedFont( "uppg12.tft" );

global.battleFuncSkillSet= new battleFuncSkillSet();

//ƒoƒgƒ‹—pŠÖ”ŒQ
class battleFuncSkillSet
{
	//ƒRƒ“ƒXƒgƒ‰ƒNƒ^
	function battleFuncSkillSet(){
	}
	
	//finalize
	function finalize(){
	}

	//“Á’èƒXƒLƒ‹ƒT[ƒ`
	function searchSkill(i,skill,side){
		var search = new Array();
		var SkillValue =  new Array();
		if(side == 'right'){search = tf.rightParty;}
		               else{search = tf.leftParty;}
		if(search[i].id != 0 || search[i].HP.now > 0){
			for(var j=0;j<search[i].skill.count;j++){
				if(search[i].skill[j].name == skill){SkillValue[0] = 1;SkillValue[1] += search[i].skill[j].value;}
			}
//dm("<searchSkill:"+i+"> Skill:"+SkillValue[0]+"/Value="+SkillValue[1]);
		}else{
			SkillValue[0] = 0;SkillValue[1] = 0;
		}
		return SkillValue;
	}

	//‘®«•ª‰ğ
	function getAttribute(i,side){
		var search    = new Array();
		var Attribute = new Array();
		var Value     = new Dictionary();
		if(side == 'right'){search = tf.rightParty;}
		               else{search = tf.leftParty;}
dm(side+"["+search[i].uniqueName+"].id="+search[i].id);
dm(side+"["+search[i].uniqueName+"].hp="+search[i].HP.now);
dm(side+"["+search[i].uniqueName+"].sp="+search[i].attribute);
		if(search[i].id != 0 || search[i].HP.now > 0){
			for(var j=0;j<search[i].attribute.length;j++){
				if(search[i].attribute.substring(j,1) == '’j'){Value.’j += 1;dm("‘®«-’j:"+Value.’j);}
				if(search[i].attribute.substring(j,1) == '—'){Value.— += 1;dm("‘®«-—:"+Value.—);}
				if(search[i].attribute.substring(j,1) == 'l'){Value.l += 1;dm("‘®«-l:"+Value.l);}
				if(search[i].attribute.substring(j,1) == '–‚'){Value.–‚ += 1;dm("‘®«-–‚:"+Value.–‚);}
				if(search[i].attribute.substring(j,1) == '_'){Value._ += 1;dm("‘®«-_:"+Value._);}
				if(search[i].attribute.substring(j,1) == '¹'){Value.¹ += 1;dm("‘®«-¹:"+Value.¹);}
				if(search[i].attribute.substring(j,1) == 'Ší'){Value.Ší += 1;dm("‘®«-Ší:"+Value.Ší);}
				if(search[i].attribute.substring(j,1) == '—³'){Value.—³ += 1;dm("‘®«-—³:"+Value.—³);}
				if(search[i].attribute.substring(j,1) == 'b'){Value.b += 1;dm("‘®«-b:"+Value.b);}
				if(search[i].attribute.substring(j,1) == 'ŠC'){Value.ŠC += 1;dm("‘®«-ŠC:"+Value.ŠC);}
				if(search[i].attribute.substring(j,1) == '”ò'){Value.”ò += 1;dm("‘®«-”ò:"+Value.”ò);}
				if(search[i].attribute.substring(j,1) == '‰Î'){Value.‰Î += 1;dm("‘®«-‰Î:"+Value.‰Î);}
				if(search[i].attribute.substring(j,1) == '—‹'){Value.—‹ += 1;dm("‘®«-—‹:"+Value.—‹);}
				if(search[i].attribute.substring(j,1) == '÷'){Value.÷ += 1;dm("‘®«-÷:"+Value.÷);}
				if(search[i].attribute.substring(j,1) == '“Å'){Value.“Å += 1;dm("‘®«-“Å:"+Value.“Å);}
				if(search[i].attribute.substring(j,1) == '•X'){Value.•X += 1;dm("‘®«-•X:"+Value.•X);}
				if(search[i].attribute.substring(j,1) == '€'){Value.€ += 1;dm("‘®«-€:"+Value.€);}
				if(search[i].attribute.substring(j,1) == '‹R'){Value.‹R += 1;dm("‘®«-‹R:"+Value.‹R);}
				if(search[i].attribute.substring(j,1) == '–é'){Value.–é += 1;dm("‘®«-–é:"+Value.–é);}
				if(search[i].attribute.substring(j,1) == '’´'){Value.’´ += 1;dm("‘®«-’´:"+Value.’´);}
			}
		}
		Attribute.assign(Value);
		return Attribute;
	}

	//“ÁUƒXƒLƒ‹ƒT[ƒ`
	function searchSpecialskill(i,side){
		var search  = new Array();
		var tactics = new Array();
		var Special =  new Array();
		var Value   =  new Dictionary();
		var c=0;
		if(side == 'right'){search = tf.rightParty;tactics = tf.tacticsSkillCountR;}
		               else{search = tf.leftParty; tactics = tf.tacticsSkillCountL;}
		if(search[i].id != 0 || search[i].HP.now > 0){
			//ƒXƒLƒ‹“ÁU
			for(var j=0;j<search[i].skill.count;j++){
				if(search[i].skill[j].name == '’j«“ÁU'){Value.’j += search[i].skill[j].value;dm("S“ÁU-’j:"+Value.’j);}
				if(search[i].skill[j].name == '—«“ÁU'){Value.— += search[i].skill[j].value;dm("S“ÁU-—:"+Value.—);}
				if(search[i].skill[j].name == 'lŠÔ“ÁU'){Value.l += search[i].skill[j].value;dm("S“ÁU-l:"+Value.l);}
				if(search[i].skill[j].name == '–‚‘°“ÁU'){Value.–‚ += search[i].skill[j].value;dm("S“ÁU-–‚:"+Value.–‚);}
				if(search[i].skill[j].name == '_‘°“ÁU'){Value._ += search[i].skill[j].value;dm("S“ÁU-_:"+Value._);}
				if(search[i].skill[j].name == '¹E“ÁU'){Value.¹ += search[i].skill[j].value;dm("S“ÁU-¹:"+Value.¹);}
				if(search[i].skill[j].name == 'Ší•º“ÁU'){Value.Ší += search[i].skill[j].value;dm("S“ÁU-Ší:"+Value.Ší);}
				if(search[i].skill[j].name == '—³‘°“ÁU'){Value.—³ += search[i].skill[j].value;dm("S“ÁU-—³:"+Value.—³);}
				if(search[i].skill[j].name == '–‚b“ÁU'){Value.b += search[i].skill[j].value;dm("S“ÁU-b:"+Value.b);}
				if(search[i].skill[j].name == '…±“ÁU'){Value.ŠC += search[i].skill[j].value;dm("S“ÁU-ŠC:"+Value.ŠC);}
				if(search[i].skill[j].name == '”òs“ÁU'){Value.”ò += search[i].skill[j].value;dm("S“ÁU-”ò:"+Value.”ò);}
				if(search[i].skill[j].name == '‰Î—ì“ÁU'){Value.‰Î += search[i].skill[j].value;dm("S“ÁU-‰Î:"+Value.‰Î);}
				if(search[i].skill[j].name == '•X—ì“ÁU'){Value.•X += search[i].skill[j].value;dm("S“ÁU-•X:"+Value.•X);}
				if(search[i].skill[j].name == '—‹—ì“ÁU'){Value.—‹ += search[i].skill[j].value;dm("S“ÁU-—‹:"+Value.—‹);}
				if(search[i].skill[j].name == '÷—ì“ÁU'){Value.÷ += search[i].skill[j].value;dm("S“ÁU-÷:"+Value.÷);}
				if(search[i].skill[j].name == '“Å«“ÁU'){Value.“Å += search[i].skill[j].value;dm("S“ÁU-“Å:"+Value.“Å);}
				if(search[i].skill[j].name == '•s€“ÁU'){Value.€ += search[i].skill[j].value;dm("S“ÁU-€:"+Value.€);}
				if(search[i].skill[j].name == '‹Rm“ÁU'){Value.‹R += search[i].skill[j].value;dm("S“ÁU-‹R:"+Value.‹R);}
				if(search[i].skill[j].name == '–és“ÁU'){Value.–é += search[i].skill[j].value;dm("S“ÁU-–é:"+Value.–é);}
				if(search[i].skill[j].name == '’´‰z“ÁU'){Value.’´ += search[i].skill[j].value;dm("S“ÁU-’´:"+Value.’´);}
			}
			//ƒ†ƒjƒbƒg“ÁU
			for(var j=0;j<search[i].special.length;j++){
				if(search[i].special.substring(j,1) == '’j'){Value.’j += 1;dm("U“ÁU-’j:"+Value.’j);}
				if(search[i].special.substring(j,1) == '—'){Value.— += 1;dm("U“ÁU-—:"+Value.—);}
				if(search[i].special.substring(j,1) == 'l'){Value.l += 1;dm("U“ÁU-l:"+Value.l);}
				if(search[i].special.substring(j,1) == '–‚'){Value.–‚ += 1;dm("U“ÁU-–‚:"+Value.–‚);}
				if(search[i].special.substring(j,1) == '_'){Value._ += 1;dm("U“ÁU-_:"+Value._);}
				if(search[i].special.substring(j,1) == '¹'){Value.¹ += 1;dm("U“ÁU-¹:"+Value.¹);}
				if(search[i].special.substring(j,1) == 'Ší'){Value.Ší += 1;dm("U“ÁU-Ší:"+Value.Ší);}
				if(search[i].special.substring(j,1) == '—³'){Value.—³ += 1;dm("U“ÁU-—³:"+Value.—³);}
				if(search[i].special.substring(j,1) == 'b'){Value.b += 1;dm("U“ÁU-b:"+Value.b);}
				if(search[i].special.substring(j,1) == 'ŠC'){Value.ŠC += 1;dm("U“ÁU-ŠC:"+Value.ŠC);}
				if(search[i].special.substring(j,1) == '”ò'){Value.”ò += 1;dm("U“ÁU-”ò:"+Value.”ò);}
				if(search[i].special.substring(j,1) == '‰Î'){Value.‰Î += 1;dm("U“ÁU-‰Î:"+Value.‰Î);}
				if(search[i].special.substring(j,1) == '—‹'){Value.—‹ += 1;dm("U“ÁU-—‹:"+Value.—‹);}
				if(search[i].special.substring(j,1) == '÷'){Value.÷ += 1;dm("U“ÁU-÷:"+Value.÷);}
				if(search[i].special.substring(j,1) == '“Å'){Value.“Å += 1;dm("U“ÁU-“Å:"+Value.“Å);}
				if(search[i].special.substring(j,1) == '•X'){Value.•X += 1;dm("U“ÁU-•X:"+Value.•X);}
				if(search[i].special.substring(j,1) == '€'){Value.€ += 1;dm("U“ÁU-€:"+Value.€);}
				if(search[i].special.substring(j,1) == '‹R'){Value.‹R += 1;dm("U“ÁU-‹R:"+Value.‹R);}
				if(search[i].special.substring(j,1) == '–é'){Value.–é += 1;dm("U“ÁU-–é:"+Value.–é);}
				if(search[i].special.substring(j,1) == '’´'){Value.’´ += 1;dm("U“ÁU-’´:"+Value.’´);}
			}
			//íp•t—^“ÁU
			for(var j=0;j<tactics.count;j++){
				if(tactics[j].substring(0,1) == '’j'){Value.’j += 1;dm("T“ÁU-’j:"+Value.’j);}
				if(tactics[j].substring(0,1) == '—'){Value.— += 1;dm("T“ÁU-—:"+Value.—);}
				if(tactics[j].substring(0,1) == 'l'){Value.l += 1;dm("T“ÁU-l:"+Value.l);}
				if(tactics[j].substring(0,1) == '–‚'){Value.–‚ += 1;dm("T“ÁU-–‚:"+Value.–‚);}
				if(tactics[j].substring(0,1) == '_'){Value._ += 1;dm("T“ÁU-_:"+Value._);}
				if(tactics[j].substring(0,1) == '¹'){Value.¹ += 1;dm("T“ÁU-¹:"+Value.¹);}
				if(tactics[j].substring(0,1) == 'Ší'){Value.Ší += 1;dm("T“ÁU-Ší:"+Value.Ší);}
				if(tactics[j].substring(0,1) == '—³'){Value.—³ += 1;dm("T“ÁU-—³:"+Value.—³);}
				if(tactics[j].substring(0,1) == 'b'){Value.b += 1;dm("T“ÁU-b:"+Value.b);}
				if(tactics[j].substring(0,1) == 'ŠC'){Value.ŠC += 1;dm("T“ÁU-ŠC:"+Value.ŠC);}
				if(tactics[j].substring(0,1) == '”ò'){Value.”ò += 1;dm("T“ÁU-”ò:"+Value.”ò);}
				if(tactics[j].substring(0,1) == '‰Î'){Value.‰Î += 1;dm("T“ÁU-‰Î:"+Value.‰Î);}
				if(tactics[j].substring(0,1) == '—‹'){Value.—‹ += 1;dm("T“ÁU-—‹:"+Value.—‹);}
				if(tactics[j].substring(0,1) == '÷'){Value.÷ += 1;dm("T“ÁU-÷:"+Value.÷);}
				if(tactics[j].substring(0,1) == '“Å'){Value.“Å += 1;dm("T“ÁU-“Å:"+Value.“Å);}
				if(tactics[j].substring(0,1) == '•X'){Value.•X += 1;dm("T“ÁU-•X:"+Value.•X);}
				if(tactics[j].substring(0,1) == '€'){Value.€ += 1;dm("T“ÁU-€:"+Value.€);}
				if(tactics[j].substring(0,1) == '‹R'){Value.‹R += 1;dm("T“ÁU-‹R:"+Value.‹R);}
				if(tactics[j].substring(0,1) == '–é'){Value.–é += 1;dm("T“ÁU-–é:"+Value.–é);}
				if(tactics[j].substring(0,1) == '’´'){Value.’´ += 1;dm("T“ÁU-’´:"+Value.’´);}
			}
		}	
		Special.assign(Value);
		return Special;
	}

	//Šˆ«‰»ƒXƒLƒ‹ˆ—
	function setActivity(name,value,side,unit){
		var activity = new Array();
		if(side == 'right'){activity = tf.rightParty;}
		               else{activity = tf.leftParty;}
dm("##### setActivity ["+unit+":"+name+"("+value+")]#####");
		for(var i=0;i<6;i++){
			if(i != unit && activity[i].id != 0){
//dm(i+":"+activity[i].unitName+"["+activity[i].attribute+"]");
				if( name == '’j«Šˆ«' && activity[i].attribute.indexOf('’j') != -1){activity[i].revise.pow += value; activity[i].revise.def += value; activity[i].revise.spd += value; activity[i].revise.mor += value\4;}
				if( name == '—«Šˆ«' && activity[i].attribute.indexOf('—') != -1){activity[i].revise.pow += value; activity[i].revise.def += value; activity[i].revise.spd += value; activity[i].revise.mor += value\4;}
				if( name == 'lŠÔŠˆ«' && activity[i].attribute.indexOf('l') != -1){activity[i].revise.pow += value; activity[i].revise.def += value; activity[i].revise.spd += value; activity[i].revise.mor += value\4;}
				if( name == '–‚‘°Šˆ«' && activity[i].attribute.indexOf('–‚') != -1){activity[i].revise.pow += value; activity[i].revise.def += value; activity[i].revise.spd += value; activity[i].revise.mor += value\4;}
				if( name == '_‘°Šˆ«' && activity[i].attribute.indexOf('_') != -1){activity[i].revise.pow += value; activity[i].revise.def += value; activity[i].revise.spd += value; activity[i].revise.mor += value\4;}
				if( name == '¹EŠˆ«' && activity[i].attribute.indexOf('¹') != -1){activity[i].revise.pow += value; activity[i].revise.def += value; activity[i].revise.spd += value; activity[i].revise.mor += value\4;}
				if( name == 'Ší•ºŠˆ«' && activity[i].attribute.indexOf('Ší') != -1){activity[i].revise.pow += value; activity[i].revise.def += value; activity[i].revise.spd += value; activity[i].revise.mor += value\4;}
				if( name == '—³‘°Šˆ«' && activity[i].attribute.indexOf('—³') != -1){activity[i].revise.pow += value; activity[i].revise.def += value; activity[i].revise.spd += value; activity[i].revise.mor += value\4;}
				if( name == '–‚bŠˆ«' && activity[i].attribute.indexOf('b') != -1){activity[i].revise.pow += value; activity[i].revise.def += value; activity[i].revise.spd += value; activity[i].revise.mor += value\4;}
				if( name == '…±Šˆ«' && activity[i].attribute.indexOf('ŠC') != -1){activity[i].revise.pow += value; activity[i].revise.def += value; activity[i].revise.spd += value; activity[i].revise.mor += value\4;}
				if( name == '”òsŠˆ«' && activity[i].attribute.indexOf('”ò') != -1){activity[i].revise.pow += value; activity[i].revise.def += value; activity[i].revise.spd += value; activity[i].revise.mor += value\4;}
				if( name == '‰Î—ìŠˆ«' && activity[i].attribute.indexOf('‰Î') != -1){activity[i].revise.pow += value; activity[i].revise.def += value; activity[i].revise.spd += value; activity[i].revise.mor += value\4;}
				if( name == '—‹—ìŠˆ«' && activity[i].attribute.indexOf('—‹') != -1){activity[i].revise.pow += value; activity[i].revise.def += value; activity[i].revise.spd += value; activity[i].revise.mor += value\4;}
				if( name == '÷—ìŠˆ«' && activity[i].attribute.indexOf('÷') != -1){activity[i].revise.pow += value; activity[i].revise.def += value; activity[i].revise.spd += value; activity[i].revise.mor += value\4;}
				if( name == '“Å«Šˆ«' && activity[i].attribute.indexOf('“Å') != -1){activity[i].revise.pow += value; activity[i].revise.def += value; activity[i].revise.spd += value; activity[i].revise.mor += value\4;}
				if( name == '•X—ìŠˆ«' && activity[i].attribute.indexOf('•X') != -1){activity[i].revise.pow += value; activity[i].revise.def += value; activity[i].revise.spd += value; activity[i].revise.mor += value\4;}
				if( name == '•s€Šˆ«' && activity[i].attribute.indexOf('€') != -1){activity[i].revise.pow += value; activity[i].revise.def += value; activity[i].revise.spd += value; activity[i].revise.mor += value\4;}
				if( name == '‹RmŠˆ«' && activity[i].attribute.indexOf('‹R') != -1){activity[i].revise.pow += value; activity[i].revise.def += value; activity[i].revise.spd += value; activity[i].revise.mor += value\4;}
				if( name == '–ésŠˆ«' && activity[i].attribute.indexOf('–é') != -1){activity[i].revise.pow += value; activity[i].revise.def += value; activity[i].revise.spd += value; activity[i].revise.mor += value\4;}
				if( name == '’´‰zŠˆ«' && activity[i].attribute.indexOf('’´') != -1){activity[i].revise.pow += value; activity[i].revise.def += value; activity[i].revise.spd += value; activity[i].revise.mor += value\4;}
				if( name == 't’cwŠö'                                             ){activity[i].revise.pow += value; activity[i].revise.def += value; activity[i].revise.spd += value; activity[i].revise.mor += value\4;dm("*YES!! ["+name+"("+value+")]");}
			}
		}
	}

	//ã‘Ì‰»ƒLƒ‹ˆ—
	function setWeaken(name,value,side,unit){
		var weaken = new Array();
		if(side == 'right'){weaken = tf.leftParty;}
		               else{weaken = tf.rightParty;}
dm("##### setWeaken ["+unit+":"+name+"("+value+")]#####");
		for(var i=0;i<6;i++){
			if(weaken[i].id != 0 && weaken[i].HP.now > 0){
//dm(i+":"+weaken[i].unitName+"["+weaken[i].attribute+"]");
				if( name == '’j«ã‘Ì' && weaken[i].attribute.indexOf('’j') != -1){weaken[i].revise.pow -= value; weaken[i].revise.def -= value; weaken[i].revise.spd -= value; weaken[i].revise.mor -= value\4;}
				if( name == '—«ã‘Ì' && weaken[i].attribute.indexOf('—') != -1){weaken[i].revise.pow -= value; weaken[i].revise.def -= value; weaken[i].revise.spd -= value; weaken[i].revise.mor -= value\4;}
				if( name == 'lŠÔã‘Ì' && weaken[i].attribute.indexOf('l') != -1){weaken[i].revise.pow -= value; weaken[i].revise.def -= value; weaken[i].revise.spd -= value; weaken[i].revise.mor -= value\4;}
				if( name == '–‚‘°ã‘Ì' && weaken[i].attribute.indexOf('–‚') != -1){weaken[i].revise.pow -= value; weaken[i].revise.def -= value; weaken[i].revise.spd -= value; weaken[i].revise.mor -= value\4;}
				if( name == '_‘°ã‘Ì' && weaken[i].attribute.indexOf('_') != -1){weaken[i].revise.pow -= value; weaken[i].revise.def -= value; weaken[i].revise.spd -= value; weaken[i].revise.mor -= value\4;}
				if( name == '¹Eã‘Ì' && weaken[i].attribute.indexOf('¹') != -1){weaken[i].revise.pow -= value; weaken[i].revise.def -= value; weaken[i].revise.spd -= value; weaken[i].revise.mor -= value\4;}
				if( name == 'Ší•ºã‘Ì' && weaken[i].attribute.indexOf('Ší') != -1){weaken[i].revise.pow -= value; weaken[i].revise.def -= value; weaken[i].revise.spd -= value; weaken[i].revise.mor -= value\4;}
				if( name == '—³‘°ã‘Ì' && weaken[i].attribute.indexOf('—³') != -1){weaken[i].revise.pow -= value; weaken[i].revise.def -= value; weaken[i].revise.spd -= value; weaken[i].revise.mor -= value\4;}
				if( name == '–‚bã‘Ì' && weaken[i].attribute.indexOf('b') != -1){weaken[i].revise.pow -= value; weaken[i].revise.def -= value; weaken[i].revise.spd -= value; weaken[i].revise.mor -= value\4;}
				if( name == '…±ã‘Ì' && weaken[i].attribute.indexOf('ŠC') != -1){weaken[i].revise.pow -= value; weaken[i].revise.def -= value; weaken[i].revise.spd -= value; weaken[i].revise.mor -= value\4;}
				if( name == '”òsã‘Ì' && weaken[i].attribute.indexOf('”ò') != -1){weaken[i].revise.pow -= value; weaken[i].revise.def -= value; weaken[i].revise.spd -= value; weaken[i].revise.mor -= value\4;}
				if( name == '‰Î—ìã‘Ì' && weaken[i].attribute.indexOf('‰Î') != -1){weaken[i].revise.pow -= value; weaken[i].revise.def -= value; weaken[i].revise.spd -= value; weaken[i].revise.mor -= value\4;}
				if( name == '—‹—ìã‘Ì' && weaken[i].attribute.indexOf('—‹') != -1){weaken[i].revise.pow -= value; weaken[i].revise.def -= value; weaken[i].revise.spd -= value; weaken[i].revise.mor -= value\4;}
				if( name == '÷—ìã‘Ì' && weaken[i].attribute.indexOf('÷') != -1){weaken[i].revise.pow -= value; weaken[i].revise.def -= value; weaken[i].revise.spd -= value; weaken[i].revise.mor -= value\4;}
				if( name == '“Å«ã‘Ì' && weaken[i].attribute.indexOf('“Å') != -1){weaken[i].revise.pow -= value; weaken[i].revise.def -= value; weaken[i].revise.spd -= value; weaken[i].revise.mor -= value\4;}
				if( name == '•X—ìã‘Ì' && weaken[i].attribute.indexOf('•X') != -1){weaken[i].revise.pow -= value; weaken[i].revise.def -= value; weaken[i].revise.spd -= value; weaken[i].revise.mor -= value\4;}
				if( name == '•s€ã‘Ì' && weaken[i].attribute.indexOf('€') != -1){weaken[i].revise.pow -= value; weaken[i].revise.def -= value; weaken[i].revise.spd -= value; weaken[i].revise.mor -= value\4;}
				if( name == '‹Rmã‘Ì' && weaken[i].attribute.indexOf('‹R') != -1){weaken[i].revise.pow -= value; weaken[i].revise.def -= value; weaken[i].revise.spd -= value; weaken[i].revise.mor -= value\4;}
				if( name == '–ésã‘Ì' && weaken[i].attribute.indexOf('–é') != -1){weaken[i].revise.pow -= value; weaken[i].revise.def -= value; weaken[i].revise.spd -= value; weaken[i].revise.mor -= value\4;}
				if( name == '’´‰zã‘Ì' && weaken[i].attribute.indexOf('’´') != -1){weaken[i].revise.pow -= value; weaken[i].revise.def -= value; weaken[i].revise.spd -= value; weaken[i].revise.mor -= value\4;}
				if( name == 't’cã‘Ì'                                           ){weaken[i].revise.pow -= value; weaken[i].revise.def -= value; weaken[i].revise.spd -= value; weaken[i].revise.mor -= value\4;}
				if( name == 'UŒ‚ã‘Ì'                                           ){weaken[i].revise.pow -= value;dm("*Noon. ["+name+"("+value+")]");}
				if( name == '–hŒäã‘Ì'                                           ){weaken[i].revise.def -= value;dm("*Noon. ["+name+"("+value+")]");}
				if( name == '‘¬“xã‘Ì'                                           ){weaken[i].revise.spd -= value;dm("*Noon. ["+name+"("+value+")]");}
				if( name == 'm‹Cã‘Ì'                                           ){weaken[i].revise.mor -= value;dm("*Noon. ["+name+"("+value+")]");}
			}
		}
	}

	//ƒ^[ƒ“ƒGƒ“ƒhƒXƒLƒ‹ˆ—
	function setTurnEndSkill(){
		tf.R_personal = [];
		tf.L_personal = [];
		for(var i=0;i<6;i++){tf.R_personal[i] = %[];tf.L_personal[i] = %[];}
		tf.R_Division = [];
		tf.L_Division = [];
		for(var i=0;i<6;i++){tf.R_Division[i] = %[];tf.L_Division[i] = %[];}
dm("## ƒ^[ƒ“ƒGƒ“ƒhƒXƒLƒ‹ˆ— ##");
dm("ƒGƒ“ƒhƒXƒLƒ‹ƒT[ƒ`");
		for(var i=0;i<6;i++){
			if(tf.rightParty[i].id != 0 && tf.rightParty[i].HP.now > 1){
				//ƒGƒ“ƒhƒAƒ“ƒ`ƒ_ƒ[ƒW(‰E)
				var SkillValue = searchSkill(i,'‘Îpá•Ç','right');//–{l
				if(SkillValue[0] == 1){tf.R_personal[i].‘Îpá•Ç = 1;tf.R_personal[i].‘Îpá•Ç’l += SkillValue[1];dm(tf.rightParty[i].unitName+":‘Îpá•Ç="+SkillValue[1]);}
				var SkillValue = searchSkill(i,'‘ÎpŒ‹ŠE','right');//‘S‘Ì
				if(SkillValue[0] == 1){tf.R_Division[i].‘ÎpŒ‹ŠE = 1;tf.R_Division[i].‘ÎpŒ‹ŠE’l += SkillValue[1];dm(tf.rightParty[i].unitName+":‘ÎpŒ‹ŠE="+SkillValue[1]);}

				//ƒGƒ“ƒhƒ_ƒ[ƒWŒn
				//‘Î’P‘Ìi‰Ej
				var SkillValue = searchSkill(i,'‰Î‰Š•úË','right');if(SkillValue[0] == 1){tf.R_personal[i].‰Î‰Š•úË = 1;tf.R_personal[i].‰Î‰Š•úË’l += SkillValue[1];dm(tf.rightParty[i].unitName+":‰Î‰Š•úË="+SkillValue[1]);}
				var SkillValue = searchSkill(i,'…—¬•úË','right');if(SkillValue[0] == 1){tf.R_personal[i].…—¬•úË = 1;tf.R_personal[i].…—¬•úË’l += SkillValue[1];dm(tf.rightParty[i].unitName+":…—¬•úË="+SkillValue[1]);}
				var SkillValue = searchSkill(i,'•XŒ‚•úË','right');if(SkillValue[0] == 1){tf.R_personal[i].•XŒ‚•úË = 1;tf.R_personal[i].•XŒ‚•úË’l += SkillValue[1];dm(tf.rightParty[i].unitName+":•XŒ‚•úË="+SkillValue[1]);}
				var SkillValue = searchSkill(i,'—‹Œ‚•úË','right');if(SkillValue[0] == 1){tf.R_personal[i].—‹Œ‚•úË = 1;tf.R_personal[i].—‹Œ‚•úË’l += SkillValue[1];dm(tf.rightParty[i].unitName+":—‹Œ‚•úË="+SkillValue[1]);}
				var SkillValue = searchSkill(i,'_p•úË','right');if(SkillValue[0] == 1){tf.R_personal[i]._p•úË = 1;tf.R_personal[i]._p•úË’l += SkillValue[1];dm(tf.rightParty[i].unitName+":_p•úË="+SkillValue[1]);}
				var SkillValue = searchSkill(i,'–‚p•úË','right');if(SkillValue[0] == 1){tf.R_personal[i].–‚p•úË = 1;tf.R_personal[i].–‚p•úË’l += SkillValue[1];dm(tf.rightParty[i].unitName+":–‚p•úË="+SkillValue[1]);}
				var SkillValue = searchSkill(i,'“Å‹C•úË','right');if(SkillValue[0] == 1){tf.R_personal[i].“Å‹C•úË = 1;tf.R_personal[i].“Å‹C•úË’l += SkillValue[1];dm(tf.rightParty[i].unitName+":“Å‹C•úË="+SkillValue[1]);}
				//‘Î‘S‘Ìi‰Ej
				var SkillValue = searchSkill(i,'‘å‰Î‰Šw','right');if(SkillValue[0] == 1){tf.R_Division[i].‘å‰Î‰Šw = 1;tf.R_Division[i].‘å‰Î‰Šw’l += SkillValue[1];dm(tf.rightParty[i].unitName+":‘å‰Î‰Šw="+SkillValue[1]);}
				var SkillValue = searchSkill(i,'‘å…—¬w','right');if(SkillValue[0] == 1){tf.R_Division[i].‘å…—¬w = 1;tf.R_Division[i].‘å…—¬w’l += SkillValue[1];dm(tf.rightParty[i].unitName+":‘å…—¬w="+SkillValue[1]);}
				var SkillValue = searchSkill(i,'‘å•XŒ‚w','right');if(SkillValue[0] == 1){tf.R_Division[i].‘å•XŒ‚w = 1;tf.R_Division[i].‘å•XŒ‚w’l += SkillValue[1];dm(tf.rightParty[i].unitName+":‘å•XŒ‚w="+SkillValue[1]);}
				var SkillValue = searchSkill(i,'‘å—‹Œ‚w','right');if(SkillValue[0] == 1){tf.R_Division[i].‘å—‹Œ‚w = 1;tf.R_Division[i].‘å—‹Œ‚w’l += SkillValue[1];dm(tf.rightParty[i].unitName+":‘å—‹Œ‚w="+SkillValue[1]);}
				var SkillValue = searchSkill(i,'‘å_pw','right');if(SkillValue[0] == 1){tf.R_Division[i].‘å_pw = 1;tf.R_Division[i].‘å_pw’l += SkillValue[1];dm(tf.rightParty[i].unitName+":‘å_pw="+SkillValue[1]);}
				var SkillValue = searchSkill(i,'‘å–‚pw','right');if(SkillValue[0] == 1){tf.R_Division[i].‘å–‚pw = 1;tf.R_Division[i].‘å–‚pw’l += SkillValue[1];dm(tf.rightParty[i].unitName+":‘å–‚pw="+SkillValue[1]);}
				var SkillValue = searchSkill(i,'‘å“Å‹Cw','right');if(SkillValue[0] == 1){tf.R_Division[i].‘å“Å‹Cw = 1;tf.R_Division[i].‘å“Å‹Cw’l += SkillValue[1];dm(tf.rightParty[i].unitName+":‘å“Å‹Cw="+SkillValue[1]);}

				//‰ñ•œŒn
				//’P‘Ì(‰E)
				var SkillValue = searchSkill(i,'©ŒÈ¡–ü','right');if(SkillValue[0] == 1){tf.R_personal[i].©ŒÈ¡–ü = 1;tf.R_personal[i].©ŒÈ¡–ü’l += SkillValue[1];dm(tf.rightParty[i].unitName+":©ŒÈ¡–ü="+SkillValue[1]);}
				var SkillValue = searchSkill(i,'‘ÎÛ¡–ü','right');if(SkillValue[0] == 1){tf.R_personal[i].‘ÎÛ¡–ü = 1;tf.R_personal[i].‘ÎÛ¡–ü’l += SkillValue[1];dm(tf.rightParty[i].unitName+":‘ÎÛ¡–ü="+SkillValue[1]);}
				//‘S‘Ì(‰E)
				var SkillValue = searchSkill(i,'‘S‘Ì¡–ü','right');if(SkillValue[0] == 1){tf.R_Division[i].‘S‘Ì¡–ü = 1;tf.R_Division[i].‘S‘Ì¡–ü’l += SkillValue[1];dm(tf.rightParty[i].unitName+":‘S‘Ì¡–ü="+SkillValue[1]);}
				var SkillValue = searchSkill(i,'•½“™¡–ü','right');if(SkillValue[0] == 1){tf.R_Division[i].•½“™¡–ü = 1;tf.R_Division[i].•½“™¡–ü’l += SkillValue[1];dm(tf.rightParty[i].unitName+":•½“™¡–ü="+SkillValue[1]);}
				var SkillValue = searchSkill(i,'–‚‘°ˆã—Ã','right');if(SkillValue[0] == 1){tf.R_Division[i].–‚‘°ˆã—Ã = 1;tf.R_Division[i].–‚‘°ˆã—Ã’l += SkillValue[1];dm(tf.rightParty[i].unitName+":–‚‘°ˆã—Ã="+SkillValue[1]);}

				//ó‘Ô‰ñ•œŒn(‰E)
				var SkillValue = searchSkill(i,'‰ğ“Å¡—Ã','right');if(SkillValue[0] == 1){tf.R_Division[i].‰ğ“Å¡—Ã = 1;dm(tf.rightParty[i].unitName+":‰ğ“Å¡—Ã="+SkillValue[1]);}
				var SkillValue = searchSkill(i,'‰ğô¡—Ã','right');if(SkillValue[0] == 1){tf.R_Division[i].‰ğô¡—Ã = 1;dm(tf.rightParty[i].unitName+":‰ğô¡—Ã="+SkillValue[1]);}
				var SkillValue = searchSkill(i,'–ƒáƒ¡—Ã','right');if(SkillValue[0] == 1){tf.R_Division[i].–ƒáƒ¡—Ã = 1;dm(tf.rightParty[i].unitName+":–ƒáƒ¡—Ã="+SkillValue[1]);}
				var SkillValue = searchSkill(i,'íŒ¸¡—Ã','right');if(SkillValue[0] == 1){tf.R_Division[i].íŒ¸¡—Ã = 1;dm(tf.rightParty[i].unitName+":íŒ¸¡—Ã="+SkillValue[1]);}
				var SkillValue = searchSkill(i,'â‘Î¡—Ã','right');if(SkillValue[0] == 1){tf.R_Division[i].â‘Î¡—Ã = 1;dm(tf.rightParty[i].unitName+":â‘Î¡—Ã="+SkillValue[1]);}

				//ƒXƒLƒ‹”½Ë‹zû(‰E)
				var SkillValue = searchSkill(i,'‘Îp”½Ë','right');if(SkillValue[0] == 1){tf.R_personal[i].‘Îp”½Ë = 1;tf.R_personal[i].‘Îp”½Ë’l += SkillValue[1];dm(tf.rightParty[i].unitName+":‘Îp”½Ë="+SkillValue[1]);}
				var SkillValue = searchSkill(i,'‘Îp‹zû','right');if(SkillValue[0] == 1){tf.R_personal[i].‘Îp‹zû = 1;tf.R_personal[i].‘Îp‹zû’l += SkillValue[1];dm(tf.rightParty[i].unitName+":‘Îp‹zû="+SkillValue[1]);}
			}

			if(tf.leftParty[i].id != 0 && tf.leftParty[i].HP.now > 1){
				//ƒGƒ“ƒhƒAƒ“ƒ`ƒ_ƒ[ƒW(¶)
				var SkillValue = searchSkill(i,'‘Îpá•Ç','left');//–{l
				if(SkillValue[0] == 1){tf.L_personal[i].‘Îpá•Ç = 1;tf.L_personal[i].‘Îpá•Ç’l += SkillValue[1];dm(tf.leftParty[i].unitName+":‘Îpá•Ç="+SkillValue[1]);}
				var SkillValue = searchSkill(i,'‘ÎpŒ‹ŠE','left');//‘S‘Ì
				if(SkillValue[0] == 1){tf.L_Division[i].‘ÎpŒ‹ŠE = 1;tf.L_Division[i].‘ÎpŒ‹ŠE’l += SkillValue[1];dm(tf.leftParty[i].unitName+":‘ÎpŒ‹ŠE="+SkillValue[1]);
				}

				//ƒGƒ“ƒhƒ_ƒ[ƒWŒn
				//‘Î’P‘Ìi¶j
				var SkillValue = searchSkill(i,'‰Î‰Š•úË','left');if(SkillValue[0] == 1){tf.L_personal[i].‰Î‰Š•úË = 1;tf.L_personal[i].‰Î‰Š•úË’l += SkillValue[1];dm(tf.leftParty[i].unitName+":‰Î‰Š•úË="+SkillValue[1]);}
				var SkillValue = searchSkill(i,'…—¬•úË','left');if(SkillValue[0] == 1){tf.L_personal[i].…—¬•úË = 1;tf.L_personal[i].…—¬•úË’l += SkillValue[1];dm(tf.leftParty[i].unitName+":…—¬•úË="+SkillValue[1]);}
				var SkillValue = searchSkill(i,'•XŒ‚•úË','left');if(SkillValue[0] == 1){tf.L_personal[i].•XŒ‚•úË = 1;tf.L_personal[i].•XŒ‚•úË’l += SkillValue[1];dm(tf.leftParty[i].unitName+":•XŒ‚•úË="+SkillValue[1]);}
				var SkillValue = searchSkill(i,'—‹Œ‚•úË','left');if(SkillValue[0] == 1){tf.L_personal[i].—‹Œ‚•úË = 1;tf.L_personal[i].—‹Œ‚•úË’l += SkillValue[1];dm(tf.leftParty[i].unitName+":—‹Œ‚•úË="+SkillValue[1]);}
				var SkillValue = searchSkill(i,'_p•úË','left');if(SkillValue[0] == 1){tf.L_personal[i]._p•úË = 1;tf.L_personal[i]._p•úË’l += SkillValue[1];dm(tf.leftParty[i].unitName+":_p•úË="+SkillValue[1]);}
				var SkillValue = searchSkill(i,'–‚p•úË','left');if(SkillValue[0] == 1){tf.L_personal[i].–‚p•úË = 1;tf.L_personal[i].–‚p•úË’l += SkillValue[1];dm(tf.leftParty[i].unitName+":–‚p•úË="+SkillValue[1]);}
				var SkillValue = searchSkill(i,'“Å‹C•úË','left');if(SkillValue[0] == 1){tf.L_personal[i].“Å‹C•úË = 1;tf.L_personal[i].“Å‹C•úË’l += SkillValue[1];dm(tf.leftParty[i].unitName+":“Å‹C•úË="+SkillValue[1]);}
				//‘Î‘S‘Ìi¶j
				var SkillValue = searchSkill(i,'‘å‰Î‰Šw','left');if(SkillValue[0] == 1){tf.L_Division[i].‘å‰Î‰Šw = 1;tf.L_Division[i].‘å‰Î‰Šw’l += SkillValue[1];dm(tf.leftParty[i].unitName+":‘å‰Î‰Šw="+SkillValue[1]);}
				var SkillValue = searchSkill(i,'‘å…—¬w','left');if(SkillValue[0] == 1){tf.L_Division[i].‘å…—¬w = 1;tf.L_Division[i].‘å…—¬w’l += SkillValue[1];dm(tf.leftParty[i].unitName+":‘å…—¬w="+SkillValue[1]);}
				var SkillValue = searchSkill(i,'‘å•XŒ‚w','left');if(SkillValue[0] == 1){tf.L_Division[i].‘å•XŒ‚w = 1;tf.L_Division[i].‘å•XŒ‚w’l += SkillValue[1];dm(tf.leftParty[i].unitName+":‘å•XŒ‚w="+SkillValue[1]);}
				var SkillValue = searchSkill(i,'‘å—‹Œ‚w','left');if(SkillValue[0] == 1){tf.L_Division[i].‘å—‹Œ‚w = 1;tf.L_Division[i].‘å—‹Œ‚w’l += SkillValue[1];dm(tf.leftParty[i].unitName+":‘å—‹Œ‚w="+SkillValue[1]);}
				var SkillValue = searchSkill(i,'‘å_pw','left');if(SkillValue[0] == 1){tf.L_Division[i].‘å_pw = 1;tf.L_Division[i].‘å_pw’l += SkillValue[1];dm(tf.leftParty[i].unitName+":‘å_pw="+SkillValue[1]);}
				var SkillValue = searchSkill(i,'‘å–‚pw','left');if(SkillValue[0] == 1){tf.L_Division[i].‘å–‚pw = 1;tf.L_Division[i].‘å–‚pw’l += SkillValue[1];dm(tf.leftParty[i].unitName+":‘å–‚pw="+SkillValue[1]);}
				var SkillValue = searchSkill(i,'‘å“Å‹Cw','left');if(SkillValue[0] == 1){tf.L_Division[i].‘å“Å‹Cw = 1;tf.L_Division[i].‘å“Å‹Cw’l += SkillValue[1];dm(tf.leftParty[i].unitName+":‘å“Å‹Cw="+SkillValue[1]);}

				//‰ñ•œŒn
				//’P‘Ì(¶)
				var SkillValue = searchSkill(i,'©ŒÈ¡–ü','left');if(SkillValue[0] == 1){tf.L_personal[i].©ŒÈ¡–ü = 1;tf.L_personal[i].©ŒÈ¡–ü’l += SkillValue[1];dm(tf.leftParty[i].unitName+":©ŒÈ¡–ü="+SkillValue[1]);}
				var SkillValue = searchSkill(i,'‘ÎÛ¡–ü','left');if(SkillValue[0] == 1){tf.L_personal[i].‘ÎÛ¡–ü = 1;tf.L_personal[i].‘ÎÛ¡–ü’l += SkillValue[1];dm(tf.leftParty[i].unitName+":‘ÎÛ¡–ü="+SkillValue[1]);}
				//‘S‘Ì(¶)
				var SkillValue = searchSkill(i,'‘S‘Ì¡–ü','left');if(SkillValue[0] == 1){tf.L_Division[i].‘S‘Ì¡–ü = 1;tf.L_Division[i].‘S‘Ì¡–ü’l += SkillValue[1];dm(tf.leftParty[i].unitName+":‘S‘Ì¡–ü="+SkillValue[1]);}
				var SkillValue = searchSkill(i,'•½“™¡–ü','left');if(SkillValue[0] == 1){tf.L_Division[i].•½“™¡–ü = 1;tf.L_Division[i].•½“™¡–ü’l += SkillValue[1];dm(tf.leftParty[i].unitName+":•½“™¡–ü="+SkillValue[1]);}
				var SkillValue = searchSkill(i,'–‚‘°ˆã—Ã','left');if(SkillValue[0] == 1){tf.L_Division[i].–‚‘°ˆã—Ã = 1;tf.L_Division[i].–‚‘°ˆã—Ã’l += SkillValue[1];dm(tf.leftParty[i].unitName+":–‚‘°ˆã—Ã="+SkillValue[1]);}

				//ó‘Ô‰ñ•œŒn(¶)
				var SkillValue = searchSkill(i,'‰ğ“Å¡—Ã','left');if(SkillValue[0] == 1){tf.L_Division[i].‰ğ“Å¡—Ã = 1;dm(tf.leftParty[i].unitName+":‰ğ“Å¡—Ã="+SkillValue[1]);}
				var SkillValue = searchSkill(i,'‰ğô¡—Ã','left');if(SkillValue[0] == 1){tf.L_Division[i].‰ğô¡—Ã = 1;dm(tf.leftParty[i].unitName+":‰ğô¡—Ã="+SkillValue[1]);}
				var SkillValue = searchSkill(i,'–ƒáƒ¡—Ã','left');if(SkillValue[0] == 1){tf.L_Division[i].–ƒáƒ¡—Ã = 1;dm(tf.leftParty[i].unitName+":–ƒáƒ¡—Ã="+SkillValue[1]);}
				var SkillValue = searchSkill(i,'íŒ¸¡—Ã','left');if(SkillValue[0] == 1){tf.L_Division[i].íŒ¸¡—Ã = 1;dm(tf.leftParty[i].unitName+":íŒ¸¡—Ã="+SkillValue[1]);}
				var SkillValue = searchSkill(i,'â‘Î¡—Ã','left');if(SkillValue[0] == 1){tf.L_Division[i].â‘Î¡—Ã = 1;dm(tf.leftParty[i].unitName+":â‘Î¡—Ã="+SkillValue[1]);}

				//ƒXƒLƒ‹”½Ë‹zû(¶)
				var SkillValue = searchSkill(i,'‘Îp”½Ë','left');if(SkillValue[0] == 1){tf.L_personal[i].‘Îp”½Ë = 1;tf.L_personal[i].‘Îp”½Ë’l += SkillValue[1];dm(tf.leftParty[i].unitName+":‘Îp”½Ë="+SkillValue[1]);}
				var SkillValue = searchSkill(i,'‘Îp‹zû','left');if(SkillValue[0] == 1){tf.L_personal[i].‘Îp‹zû = 1;tf.L_personal[i].‘Îp‹zû’l += SkillValue[1];dm(tf.leftParty[i].unitName+":‘Îp‹zû="+SkillValue[1]);}
			}
		}
	}

	function calcTurnEndSkill(){
		var Rdamage    = [];var Ldamage    = [];
		var Rrecovery  = [];var Lrecovery  = [];
		var RdamageP   = [];var LdamageP   = [];
		var RfortAttack= [];var LfortAttack= [];
		var RfortRepair= [];var LfortRepair= [];
		for(var i=0;i<6;i++){
			if(tf.leftParty[i].id == 0){continue;}
			//UŒ‚
		dm("--’PUŒ‚(‘Î¶)--");
			//‘ÎÛF“G(¶)ƒ^[ƒQƒbƒg
			if( tf.allyTarget == i){
				for(var n=0;n<6;n++){
					//‰Î‰Š•úË
					if(tf.R_personal[n].‰Î‰Š•úË == 1 && tf.leftParty[i].attribute.indexOf('‰Î') == -1 && (tf.rightParty[n].seal < 1 && tf.rightParty[n].charm < 1)){
						Ldamage[i] += calc.turnEndSkillCalc(tf.rightParty[n].HP.now,tf.R_personal[n].‰Î‰Š•úË’l);
						dm(tf.leftParty[i].unitName+":Ldamage["+i+"]="+Ldamage[i]+"/‰Î‰Š•úË");
					}
					//…—¬•úË
					if(tf.R_personal[n].…—¬•úË == 1 && tf.leftParty[i].attribute.indexOf('ŠC') == -1 && (tf.rightParty[n].seal < 1 && tf.rightParty[n].charm < 1)){
						Ldamage[i] += calc.turnEndSkillCalc(tf.rightParty[n].HP.now,tf.R_personal[n].…—¬•úË’l);
						dm(tf.leftParty[i].unitName+":Ldamage["+i+"]="+Ldamage[i]+"/…—¬•úË");
					}
					//•XŒ‚•úË
					if(tf.R_personal[n].•XŒ‚•úË == 1 && tf.leftParty[i].attribute.indexOf('•X') == -1 && (tf.rightParty[n].seal < 1 && tf.rightParty[n].charm < 1)){
						Ldamage[i] += calc.turnEndSkillCalc(tf.rightParty[n].HP.now,tf.R_personal[n].•XŒ‚•úË’l);
						dm(tf.leftParty[i].unitName+":Ldamage["+i+"]="+Ldamage[i]+"/•XŒ‚•úË");
					}
					//—‹Œ‚•úË
					if(tf.R_personal[n].—‹Œ‚•úË == 1 && tf.leftParty[i].attribute.indexOf('—‹') == -1 && (tf.rightParty[n].seal < 1 && tf.rightParty[n].charm < 1)){
						Ldamage[i] += calc.turnEndSkillCalc(tf.rightParty[n].HP.now,tf.R_personal[n].—‹Œ‚•úË’l);
						dm(tf.leftParty[i].unitName+":Ldamage["+i+"]="+Ldamage[i]+"/—‹Œ‚•úË");
					}
					//_p•úË
					if(tf.R_personal[n]._p•úË == 1 && (tf.rightParty[n].seal < 1 && tf.rightParty[n].charm < 1)){
						Ldamage[i] += calc.turnEndSkillCalc(tf.rightParty[n].HP.now,tf.R_personal[n]._p•úË’l);
						dm(tf.leftParty[i].unitName+":Ldamage["+i+"]="+Ldamage[i]+"/_p•úË");
					}
					//–‚p•úË
					if(tf.R_personal[n].–‚p•úË == 1 && (tf.rightParty[n].seal < 1 && tf.rightParty[n].charm < 1)){
						Ldamage[i] += calc.turnEndSkillCalc(tf.rightParty[n].HP.now,tf.R_personal[n].–‚p•úË’l);
						dm(tf.leftParty[i].unitName+":Ldamage["+i+"]="+Ldamage[i]+"/–‚p•úË");
					}
					//“Å‹C•úË(ŒyŒ¸•s‰Â)
					if(tf.R_personal[n].“Å‹C•úË == 1 && (tf.leftParty[i].attribute.indexOf('“Å') == -1 && tf.leftParty[i].attribute.indexOf('€') == -1 && tf.leftParty[i].attribute.indexOf('Ší') == -1) && (tf.rightParty[n].seal < 1 && tf.rightParty[n].charm < 1)){
						LdamageP[i] += calc.turnEndSkillCalc(tf.rightParty[n].HP.now,tf.R_personal[n].“Å‹C•úË’l);
						dm(tf.leftParty[i].unitName+":LdamageP["+i+"]="+LdamageP[i]+"/“Å‹C•úË");
					}
				}
			}

		dm("--‘SUŒ‚(‘Î¶)--");
			//‘ÎÛF“G‘S‘Ì(¶)
			for(var n=0;n<6;n++){
				//‘å‰Î‰Šw
				if(tf.R_Division[n].‘å‰Î‰Šw == 1 && tf.leftParty[i].attribute.indexOf('‰Î') == -1 && (tf.rightParty[n].seal < 1 && tf.rightParty[n].charm < 1)){
					Ldamage[i] += calc.turnEndSkillCalc(tf.rightParty[n].HP.now,tf.R_Division[n].‘å‰Î‰Šw’l);
					dm(tf.leftParty[i].unitName+":Ldamage["+i+"]="+Ldamage[i]+"/‘å‰Î‰Šw");
				}
				//‘å…—¬w
				if(tf.R_Division[n].‘å…—¬w == 1 && tf.leftParty[i].attribute.indexOf('ŠC') == -1 && (tf.rightParty[n].seal < 1 && tf.rightParty[n].charm < 1)){
					Ldamage[i] += calc.turnEndSkillCalc(tf.rightParty[n].HP.now,tf.R_Division[n].‘å…—¬w’l);
					dm(tf.leftParty[i].unitName+":Ldamage["+i+"]="+Ldamage[i]+"/‘å…—¬w");
				}
				//‘å•XŒ‚w
				if(tf.R_Division[n].‘å•XŒ‚w == 1 && tf.leftParty[i].attribute.indexOf('•X') == -1 && (tf.rightParty[n].seal < 1 && tf.rightParty[n].charm < 1)){
					Ldamage[i] += calc.turnEndSkillCalc(tf.rightParty[n].HP.now,tf.R_Division[n].‘å•XŒ‚w’l);
					dm(tf.leftParty[i].unitName+":Ldamage["+i+"]="+Ldamage[i]+"/‘å•XŒ‚w");
				}
				//‘å—‹Œ‚w
				if(tf.R_Division[n].‘å—‹Œ‚w == 1 && tf.leftParty[i].attribute.indexOf('—‹') == -1 && (tf.rightParty[n].seal < 1 && tf.rightParty[n].charm < 1)){
					Ldamage[i] += calc.turnEndSkillCalc(tf.rightParty[n].HP.now,tf.R_Division[n].‘å—‹Œ‚w’l);
					dm(tf.leftParty[i].unitName+":Ldamage["+i+"]="+Ldamage[i]+"/‘å—‹Œ‚w");
				}
				//‘å_pw
				if(tf.R_Division[n].‘å_pw == 1 && (tf.rightParty[n].seal < 1 && tf.rightParty[n].charm < 1)){
					Ldamage[i] += calc.turnEndSkillCalc(tf.rightParty[n].HP.now,tf.R_Division[n].‘å_pw’l);
					dm(tf.leftParty[i].unitName+":Ldamage["+i+"]="+Ldamage[i]+"/‘å_pw");
				}
				//‘å–‚pw
				if(tf.R_Division[n].‘å–‚pw == 1 && (tf.rightParty[n].seal < 1 && tf.rightParty[n].charm < 1)){
					Ldamage[i] += calc.turnEndSkillCalc(tf.rightParty[n].HP.now,tf.R_Division[n].‘å–‚pw’l);
					dm(tf.leftParty[i].unitName+":Ldamage["+i+"]="+Ldamage[i]+"/‘å–‚pw");
				}
				//‘å“Å‹Cw
				if(tf.R_Division[n].‘å“Å‹Cw == 1 && (tf.leftParty[i].attribute.indexOf('“Å') == -1 && tf.leftParty[i].attribute.indexOf('€') == -1 && tf.leftParty[i].attribute.indexOf('Ší') == -1) && (tf.rightParty[n].seal < 1 && tf.rightParty[n].charm < 1)){
					LdamageP[i] += calc.turnEndSkillCalc(tf.rightParty[n].HP.now,tf.R_Division[n].‘å“Å‹Cw’l);
					dm(tf.leftParty[i].unitName+":LdamageP["+i+"]="+LdamageP[i]+"/‘å“Å‹Cw");
				}
			}

		dm("--’P‰ñ•œ(‘Î¶)--");
			//‘ÎÛF©ŒÈ(¶)
			//©ŒÈ¡–ü
			if(tf.L_personal[i].©ŒÈ¡–ü == 1 && tf.leftParty[i].curse < 1 && (tf.leftParty[i].seal < 1 && tf.leftParty[i].charm < 1)){
				 Lrecovery[i] += calc.turnEndSkillCalc(tf.leftParty[i].HP.now,tf.L_personal[i].©ŒÈ¡–ü’l);
				dm(tf.leftParty[i].unitName+":Lrecovery["+i+"]="+Lrecovery[i]+"/©ŒÈ¡–ü");
			}
			//‘ÎÛFƒ^[ƒQƒbƒg(¶)
			//‘ÎÛ¡–ü
			if( tf.allyTarget == i){
				for(var n=0;n<6;n++){
					if(tf.L_personal[n].‘ÎÛ¡–ü == 1 && tf.leftParty[i].curse < 1 && tf.leftParty[i].attribute.indexOf('€') == -1 && (tf.leftParty[n].seal < 1 && tf.leftParty[n].charm < 1)){
						 Lrecovery[i] += calc.turnEndSkillCalc(tf.leftParty[n].HP.now,tf.L_personal[n].‘ÎÛ¡–ü’l);
						dm(tf.leftParty[i].unitName+":Lrecovery["+i+"]="+Lrecovery[i]+"/‘ÎÛ¡–ü");dm("À¹Ş="+tf.allyTarget);
					}
				}
			}

		dm("--‘S‰ñ•œ(‘Î¶)--");
			//‘ÎÛF©‘S‘Ì(¶)
			for(var n=0;n<6;n++){
				//‘S‘Ì¡–ü
				if(tf.L_Division[n].‘S‘Ì¡–ü == 1 && tf.leftParty[i].curse < 1 && tf.leftParty[i].attribute.indexOf('€') == -1 && (tf.leftParty[n].seal < 1 && tf.leftParty[n].charm < 1)){
					 Lrecovery[i] += calc.turnEndSkillCalc(tf.leftParty[n].HP.now,tf.L_Division[n].‘S‘Ì¡–ü’l);
					dm(tf.rightParty[n].unitName+"<-‘S‘Ì¡–ü");
					dm(tf.leftParty[i].unitName+":Lrecovery["+i+"]="+Lrecovery[i]+"/‘S‘Ì¡–ü");
				}
				//•½“™¡–ü
				if(tf.L_Division[n].•½“™¡–ü == 1 && tf.leftParty[i].curse < 1 && (tf.leftParty[i].seal < 1 && tf.leftParty[i].charm < 1)){
					 Lrecovery[i] += calc.turnEndSkillCalc(tf.leftParty[n].HP.now,tf.L_Division[n].•½“™¡–ü’l);
					dm(tf.rightParty[n].unitName+"<-•½“™¡–ü");
					dm(tf.leftParty[i].unitName+":Lrecovery["+i+"]="+Lrecovery[i]+"/•½“™¡–ü");
				}
				//–‚‘°ˆã—Ã
				if(tf.L_Division[n].–‚‘°ˆã—Ã == 1 && tf.leftParty[i].curse < 1 && (tf.leftParty[i].attribute.indexOf('€') != -1 || tf.leftParty[i].attribute.indexOf('–‚') != -1) && (tf.leftParty[n].seal < 1 && tf.leftParty[n].charm < 1)){
					 Lrecovery[i] += calc.turnEndSkillCalc(tf.leftParty[n].HP.now,tf.L_Division[n].–‚‘°ˆã—Ã’l);
					dm(tf.rightParty[n].unitName+"<-–‚‘°ˆã—Ã");
					dm(tf.leftParty[i].unitName+":Lrecovery["+i+"]="+Lrecovery[i]+"/–‚‘°ˆã—Ã");
				}
			}

			//¡—Ã
		dm("--¡—Ã(‘Î¶)--");
			//‘ÎÛF“G‘S‘Ì(¶)
			for(var n=0;n<6;n++){
				//‰ğ“Å¡—Ã
				if(tf.L_Division[n].‰ğ“Å¡—Ã == 1 && (tf.leftParty[n].seal < 1 && tf.leftParty[n].charm < 1)){tf.leftParty[i].poison   = 0;}
				//‰ğô¡—Ã
				if(tf.L_Division[n].‰ğô¡—Ã == 1 && (tf.leftParty[n].seal < 1 && tf.leftParty[n].charm < 1)){tf.leftParty[i].curse    = 0;}
				//–ƒáƒ¡—Ã
				if(tf.L_Division[n].–ƒáƒ¡—Ã == 1 && (tf.leftParty[n].seal < 1 && tf.leftParty[n].charm < 1)){tf.leftParty[i].paralyze = 0;}
				//íŒ¸¡—Ã
				if(tf.L_Division[n].íŒ¸¡—Ã == 1 && (tf.leftParty[n].seal < 1 && tf.leftParty[n].charm < 1)){
					tf.leftParty[i].cutDown.pow = 0;
					tf.leftParty[i].cutDown.def = 0;
					tf.leftParty[i].cutDown.spd = 0;
					tf.leftParty[i].cutDown.mor = 0;
				}
			}

			//ˆÙí
		dm("--ˆÙí(‘Î¶)--");
			//“G©ŒÈ(¶)
			if(tf.leftParty[i].poison > 0){
				LdamageP[i] += (int)(tf.leftParty[i].HP.now * (tf.leftParty[i].poison / 100));
				dm(tf.leftParty[i].unitName+":Ldamage["+i+"]="+Ldamage[i]+"/“Å‰»Œ¸Z");
			}
		}

		for(var i=0;i<6;i++){
			if(tf.rightParty[i].id == 0){continue;}
			//UŒ‚
		dm("--’PUŒ‚(‘Î‰E)--");
			//‘ÎÛF“G(‰E)ƒ^[ƒQƒbƒg
			if( tf.enemyTarget == i){
				for(var n=0;n<6;n++){
					//‰Î‰Š•úË
					if(tf.L_personal[n].‰Î‰Š•úË == 1 && tf.rightParty[i].attribute.indexOf('‰Î') == -1 && (tf.leftParty[n].seal < 1 && tf.leftParty[n].charm < 1)){
						Rdamage[i] += calc.turnEndSkillCalc(tf.leftParty[n].HP.now,tf.L_personal[n].‰Î‰Š•úË’l);
						dm(tf.rightParty[i].unitName+":Rdamage["+i+"]="+Rdamage[i]+"/‰Î‰Š•úË");
					}
					//…—¬•úË
					if(tf.L_personal[n].…—¬•úË == 1 && tf.rightParty[i].attribute.indexOf('ŠC') == -1 && (tf.leftParty[n].seal < 1 && tf.leftParty[n].charm < 1)){
						Rdamage[i] += calc.turnEndSkillCalc(tf.leftParty[n].HP.now,tf.L_personal[n].…—¬•úË’l);
						dm(tf.rightParty[i].unitName+":Rdamage["+i+"]="+Rdamage[i]+"/…—¬•úË");
					}
					//•XŒ‚•úË
					if(tf.L_personal[n].•XŒ‚•úË == 1 && tf.rightParty[i].attribute.indexOf('•X') == -1 && (tf.leftParty[n].seal < 1 && tf.leftParty[n].charm < 1)){
						Rdamage[i] += calc.turnEndSkillCalc(tf.leftParty[n].HP.now,tf.L_personal[n].•XŒ‚•úË’l);
						dm(tf.rightParty[i].unitName+":Rdamage["+i+"]="+Rdamage[i]+"/•XŒ‚•úË");
					}
					//—‹Œ‚•úË
					if(tf.L_personal[n].—‹Œ‚•úË == 1 && tf.rightParty[i].attribute.indexOf('—‹') == -1 && (tf.leftParty[n].seal < 1 && tf.leftParty[n].charm < 1)){
						Rdamage[i] += calc.turnEndSkillCalc(tf.leftParty[n].HP.now,tf.L_personal[n].—‹Œ‚•úË’l);
						dm(tf.rightParty[i].unitName+":Rdamage["+i+"]="+Rdamage[i]+"/—‹Œ‚•úË");
					}
					//_p•úË
					if(tf.L_personal[n]._p•úË == 1 && (tf.leftParty[n].seal < 1 && tf.leftParty[n].charm < 1)){
						Rdamage[i] += calc.turnEndSkillCalc(tf.leftParty[n].HP.now,tf.L_personal[n]._p•úË’l);
						dm(tf.rightParty[i].unitName+":Rdamage["+i+"]="+Rdamage[i]+"/_p•úË");
					}
					//–‚p•úË
					if(tf.L_personal[n].–‚p•úË == 1 && (tf.leftParty[i].seal < 1 && tf.leftParty[i].charm < 1)){
						Rdamage[i] += calc.turnEndSkillCalc(tf.leftParty[n].HP.now,tf.L_personal[n].–‚p•úË’l);
						dm(tf.rightParty[i].unitName+":Rdamage["+i+"]="+Rdamage[i]+"/–‚p•úË");
					}
					//“Å‹C•úË(ŒyŒ¸•s‰Â)
					if(tf.L_personal[n].“Å‹C•úË == 1 && (tf.rightParty[i].attribute.indexOf('“Å') == -1 || tf.rightParty[i].attribute.indexOf('€') == -1 || tf.rightParty[i].attribute.indexOf('Ší') == -1) && (tf.leftParty[n].seal < 1 && tf.leftParty[n].charm < 1)){
						RdamageP[i] += calc.turnEndSkillCalc(tf.leftParty[n].HP.now,tf.L_personal[n].“Å‹C•úË’l);
						dm(tf.rightParty[i].unitName+":RdamageP["+i+"]="+RdamageP[i]+"/“Å‹C•úË");
					}
				}
			}

		dm("--‘SUŒ‚(‘Î‰E)--");
			//‘ÎÛF©‘S‘Ì(‰E)
			for(var n=0;n<6;n++){
				//‘å‰Î‰Šw
				if(tf.L_Division[n].‘å‰Î‰Šw == 1 && tf.rightParty[i].attribute.indexOf('‰Î') == -1 && (tf.leftParty[n].seal < 1 && tf.leftParty[n].charm < 1)){
					Rdamage[i] += calc.turnEndSkillCalc(tf.leftParty[n].HP.now,tf.L_Division[n].‘å‰Î‰Šw’l);
					dm(tf.rightParty[i].unitName+":Rdamage["+i+"]="+Rdamage[i]+"/‘å‰Î‰Šw");
				}
				//‘å…—¬w
				if(tf.L_Division[n].‘å…—¬w == 1 && tf.rightParty[i].attribute.indexOf('ŠC') == -1 && (tf.leftParty[n].seal < 1 && tf.leftParty[n].charm < 1)){
					Rdamage[i] += calc.turnEndSkillCalc(tf.leftParty[n].HP.now,tf.L_Division[n].‘å…—¬w’l);
					dm(tf.rightParty[i].unitName+":Rdamage["+i+"]="+Rdamage[i]+"/‘å…—¬w");
				}
				//‘å•XŒ‚w
				if(tf.L_Division[n].‘å•XŒ‚w == 1 && tf.rightParty[i].attribute.indexOf('•X') == -1 && (tf.leftParty[n].seal < 1 && tf.leftParty[n].charm < 1)){
					Rdamage[i] += calc.turnEndSkillCalc(tf.leftParty[n].HP.now,tf.L_Division[n].‘å•XŒ‚w’l);
					dm(tf.rightParty[i].unitName+":Rdamage["+i+"]="+Rdamage[i]+"/‘å•XŒ‚w");
				}
				//‘å—‹Œ‚w
				if(tf.L_Division[n].‘å—‹Œ‚w == 1 && tf.rightParty[i].attribute.indexOf('—‹') == -1 && (tf.leftParty[n].seal < 1 && tf.leftParty[n].charm < 1)){
					Rdamage[i] += calc.turnEndSkillCalc(tf.leftParty[n].HP.now,tf.L_Division[n].‘å—‹Œ‚w’l);
					dm(tf.rightParty[i].unitName+":Rdamage["+i+"]="+Rdamage[i]+"/‘å—‹Œ‚w");
				}
				//‘å_pw
				if(tf.L_Division[n].‘å_pw == 1 && (tf.leftParty[n].seal < 1 && tf.leftParty[n].charm < 1)){
					Rdamage[i] += calc.turnEndSkillCalc(tf.leftParty[n].HP.now,tf.L_Division[n].‘å_pw’l);
					dm(tf.rightParty[i].unitName+":Rdamage["+i+"]="+Rdamage[i]+"/‘å_pw");
				}
				//‘å–‚pw
				if(tf.L_Division[n].‘å–‚pw == 1 && (tf.leftParty[n].seal < 1 && tf.leftParty[n].charm < 1)){
					Rdamage[i] += calc.turnEndSkillCalc(tf.leftParty[n].HP.now,tf.L_Division[n].‘å–‚pw’l);
					dm(tf.rightParty[i].unitName+":Rdamage["+i+"]="+Rdamage[i]+"/‘å–‚pw");
				}
				//‘å“Å‹Cw
				if(tf.L_Division[n].‘å“Å‹Cw == 1 && (tf.rightParty[i].attribute.indexOf('“Å') == -1 || tf.rightParty[i].attribute.indexOf('€') == -1 || tf.rightParty[i].attribute.indexOf('Ší') == -1) && (tf.leftParty[n].seal < 1 && tf.leftParty[n].charm < 1)){
					RdamageP[i] += calc.turnEndSkillCalc(tf.leftParty[n].HP.now,tf.L_Division[n].‘å“Å‹Cw’l);
					dm(tf.rightParty[i].unitName+":RdamageP["+i+"]="+RdamageP[i]+"/‘å“Å‹Cw");
				}
			}

			//¡–ü
		dm("--’P¡–ü(‘Î‰E)--");
			//‘ÎÛF©ŒÈ(‰E)
			//©ŒÈ¡–ü
			if(tf.R_personal[i].©ŒÈ¡–ü == 1 && tf.rightParty[i].curse < 1 && (tf.rightParty[i].seal < 1 && tf.rightParty[i].charm < 1)){
				 Rrecovery[i] += calc.turnEndSkillCalc(tf.rightParty[i].HP.now,tf.R_personal[i].©ŒÈ¡–ü’l);
				dm(tf.rightParty[i].unitName+":Rrecovery["+i+"]="+Rrecovery[i]+"/©ŒÈ¡–ü");
			}
			//‘ÎÛFƒ^[ƒQƒbƒg(‰E)
			//‘ÎÛ¡–ü
			if( tf.enemyTarget == i){
				for(var n=0;n<6;n++){
					if(tf.R_personal[n].‘ÎÛ¡–ü == 1 && tf.rightParty[i].curse < 1 && tf.rightParty[i].attribute.indexOf('€') == -1 && (tf.rightParty[n].seal < 1 && tf.rightParty[n].charm < 1)){
						 Rrecovery[i] += calc.turnEndSkillCalc(tf.rightParty[n].HP.now,tf.R_personal[n].‘ÎÛ¡–ü’l);
						dm(tf.rightParty[i].unitName+":Rrecovery["+i+"]="+Rrecovery[i]+"/‘ÎÛ¡–ü");
					}
				}
			}

		dm("--‘S’P¡–ü(‘Î‰E)--");
			//‘ÎÛF©‘S‘Ì(‰E)
			for(var n=0;n<6;n++){
				//‘S‘Ì¡–ü
				if(tf.R_Division[n].‘S‘Ì¡–ü == 1 && tf.rightParty[i].curse < 1 && tf.rightParty[i].attribute.indexOf('€') == -1 && (tf.rightParty[n].seal < 1 && tf.rightParty[n].charm < 1)){
					Rrecovery[i] += calc.turnEndSkillCalc(tf.rightParty[n].HP.now,tf.R_Division[n].‘S‘Ì¡–ü’l);
					dm(tf.rightParty[n].unitName+"<-‘S‘Ì¡–ü");
					dm(tf.rightParty[i].unitName+":Rrecovery["+i+"]="+Rrecovery[i]+"/‘S‘Ì¡–ü");
				}
				//•½“™¡–ü
				if(tf.R_Division[n].•½“™¡–ü == 1 && tf.rightParty[i].curse < 1 && (tf.rightParty[n].seal < 1 && tf.rightParty[n].charm < 1)){
					Rrecovery[i] += calc.turnEndSkillCalc(tf.rightParty[n].HP.now,tf.R_Division[n].•½“™¡–ü’l);
					dm(tf.rightParty[n].unitName+"<-•½“™¡–ü");
					dm(tf.rightParty[i].unitName+":Rrecovery["+i+"]="+Rrecovery[i]+"/•½“™¡–ü");
				}
				//–‚‘°ˆã—Ã
				if(tf.R_Division[n].–‚‘°ˆã—Ã == 1 && tf.rightParty[i].curse < 1 && (tf.rightParty[i].attribute.indexOf('€') != -1 || tf.rightParty[i].attribute.indexOf('–‚') != -1) && (tf.rightParty[n].seal < 1 && tf.rightParty[n].charm < 1)){
					Rrecovery[i] += calc.turnEndSkillCalc(tf.rightParty[n].HP.now,tf.R_Division[n].–‚‘°ˆã—Ã’l);
					dm(tf.rightParty[n].unitName+"<-–‚‘°ˆã—Ã");
					dm(tf.rightParty[i].unitName+":Rrecovery["+i+"]="+Rrecovery[i]+"/–‚‘°ˆã—Ã");
				}
			}

			//¡—Ã
		dm("--¡—Ã(‘Î‰E)--");
			//‘ÎÛF©‘S‘Ì(‰E)
			for(var n=0;n<6;n++){
				//‰ğ“Å¡—Ã
				if(tf.R_Division[n].‰ğ“Å¡—Ã == 1 && (tf.rightParty[n].seal < 1 && tf.rightParty[n].charm < 1)){tf.rightParty[i].poison   = 0;}
				//‰ğô¡—Ã
				if(tf.R_Division[n].‰ğô¡—Ã == 1 && (tf.rightParty[n].seal < 1 && tf.rightParty[n].charm < 1)){tf.rightParty[i].curse    = 0;}
				//–ƒáƒ¡—Ã
				if(tf.R_Division[n].–ƒáƒ¡—Ã == 1 && (tf.rightParty[n].seal < 1 && tf.rightParty[n].charm < 1)){tf.rightParty[i].paralyze = 0;}
				//íŒ¸¡—Ã
				if(tf.R_Division[n].íŒ¸¡—Ã == 1 && (tf.rightParty[n].seal < 1 && tf.rightParty[n].charm < 1)){
					tf.rightParty[i].cutDown.pow = 0;
					tf.rightParty[i].cutDown.def = 0;
					tf.rightParty[i].cutDown.spd = 0;
					tf.rightParty[i].cutDown.mor = 0;
				}
			}

			//ˆÙí
		dm("--ˆÙí(‘Î‰E)--");
			//ó‘ÔˆÙí(“Å)
			//©©ŒÈ(‰E)
			if(tf.rightParty[i].poison > 0){
				RdamageP[i] += (int)(tf.rightParty[i].HP.now * (tf.rightParty[i].poison / 100));
				dm(tf.rightParty[i].unitName+":RdamageP["+i+"]="+RdamageP[i]+"/“Å‰»Œ¸Z");
			}
		}

		for(var i=0;i<6;i++){
			var tmp;
			//”½Ë
			dm("--”½Ë(¶)--");
			//‘ÎÛF“Gƒ^[ƒQƒbƒg
			if(tf.L_personal[i].‘Îp”½Ë == 1 && (tf.leftParty[i].seal < 1 || tf.leftParty[i].charm < 1)){
				Rdamage[tf.enemyTarget] += (int)(Ldamage[i] * (tf.L_personal[i].‘Îp”½Ë’l / 100));
				tmp = 1;
				dm(tf.leftParty[i].unitName+"<-‘Îp”½Ë");
				dm(tf.rightParty[tf.enemyTarget].unitName+":Rdamage["+tf.enemyTarget+"]="+Rdamage[tf.enemyTarget]+"/‘Îp”½Ë");
			}

			//‹zû
			dm("--‹zû(¶)--");
			//‘ÎÛF©•ª
			if(tf.L_personal[i].‘Îp‹zû == 1 && (tf.leftParty[i].seal < 1 || tf.leftParty[i].charm < 1)){
				Lrecovery[i] += (int)(Ldamage[i] * (tf.L_personal[i].‘Îp‹zû’l / 100));//‹zû’l
				tmp = 1;
				dm(tf.leftParty[i].unitName+"<-‘Îp‹zû");
				dm(tf.leftParty[i].unitName+":Lrecovery["+i+"]="+Lrecovery[i]+"/‘Îp‹zû");
			}

			//ƒ_ƒ[ƒW–³Œø‰»
			if(tmp == 1){
				Ldamage[i] = 0;
			}
		}

		for(var i=0;i<6;i++){
			var tmp;
			//”½Ë
			dm("--”½Ë(‰E)--");
			//‘ÎÛF“Gƒ^[ƒQƒbƒg
			if(tf.R_personal[i].‘Îp”½Ë == 1 && (tf.rightParty[i].seal < 1 || tf.rightParty[i].charm < 1)){
				Ldamage[tf.allyTarget] += (int)(Rdamage[i] * (tf.R_personal[i].‘Îp”½Ë’l / 100));
				tmp = 1;
				dm(tf.rightParty[i].unitName+"<-‘Îp”½Ë");
				dm(tf.leftParty[tf.allyTarget].unitName+":Ldamage["+tf.allyTarget+"]="+Ldamage[tf.allyTarget]+"/‘Îp”½Ë");
			}

			//‹zû
			dm("--‹zû(‰E)--");
			//‘ÎÛF©•ª
			if(tf.R_personal[i].‘Îp‹zû == 1 && (tf.rightParty[i].seal < 1 || tf.rightParty[i].charm < 1)){
				Rrecovery[i] += (int)(Rdamage[i] * (tf.R_personal[i].‘Îp‹zû’l / 100));//‹zû’l
				tmp = 1;
				dm(tf.rightParty[i].unitName+"<-‘Îp‹zû");
				dm(tf.rightParty[i].unitName+":Rrecovery["+i+"]="+Rrecovery[i]+"/‘Îp‹zû");
			}

			//ƒ_ƒ[ƒW–³Œø‰»
			if(tmp == 1){
				Rdamage[i] = 0;
			}
		}

		for(var i=0;i<6;i++){
			if(tf.leftParty[i].id == 0){continue;}
			//Œ¸Z
			dm("--Œ¸Z(‘Î¶)--");
			//‘ÎÛF“G©ŒÈ(¶)
			if(tf.L_personal[i].‘Îpá•Ç == 1 && (tf.leftParty[i].seal < 1 || tf.leftParty[i].charm < 1)){
dm("L.‘Îpá•Ç’l="+tf.L_personal[i].‘Îpá•Ç’l);
				Ldamage[i] -= (int)(Ldamage[i] * (tf.L_personal[i].‘Îpá•Ç’l / 100));
				dm(tf.leftParty[i].unitName+":Ldamage["+i+"]="+Ldamage[i]+"/‘Îpá•Ç");
			}
			//‘ÎÛF‘S‘Ì(¶)
			for(var n=0;n<6;n++){
				if(tf.L_Division[i].‘ÎpŒ‹ŠE == 1 && (tf.leftParty[n].seal < 1 || tf.leftParty[n].charm < 1)){
					Ldamage[n] -= (int)(Ldamage[n] * (tf.L_Division[i].‘ÎpŒ‹ŠE’l / 100));
					dm(tf.leftParty[n].unitName+":Ldamage["+n+"]="+Ldamage[n]+"/‘ÎpŒ‹ŠE");
				}
			}
		}

		for(var i=0;i<6;i++){
			if(tf.rightParty[i].id == 0){continue;}
			//Œ¸Z
			dm("--Œ¸Z(‘Î‰E)--");
			//‘ÎÛF©©ŒÈ(‰E)
			if(tf.R_personal[i].‘Îpá•Ç == 1 && (tf.rightParty[i].seal < 1 || tf.rightParty[i].charm < 1)){
dm("R.‘Îpá•Ç’l="+tf.R_personal[i].‘Îpá•Ç’l);
				Rdamage[i] -= (int)(Rdamage[i] * (tf.R_personal[i].‘Îpá•Ç’l / 100));
				dm(tf.rightParty[i].unitName+":Rdamage["+i+"]="+Rdamage[i]+"/‘Îpá•Ç");
			}
			//‘ÎÛF‘S‘Ì(‰E)
			for(var n=0;n<6;n++){
				if(tf.R_Division[i].‘ÎpŒ‹ŠE == 1 && (tf.rightParty[n].seal < 1 || tf.rightParty[n].charm < 1)){
					Rdamage[n] -= (int)(Rdamage[n] * (tf.R_Division[i].‘ÎpŒ‹ŠE’l / 100));
					dm(tf.rightParty[i].unitName+":Rdamage["+n+"]="+Rdamage[n]+"/‘ÎpŒ‹ŠE");
				}
			}
		}

		//‡ZŒ‹‰Ê
		tf.turnEndDamageR   = [];tf.turnEndDamageL   = [];
		tf.turnEndRecoveryR = [];tf.turnEndRecoveryL = [];
		tf.fortAttackR = [];tf.fortAttackL = [];
		tf.fortRepairR = [];tf.fortRepairL = [];
		dm("--‡Z--");
		for(var i=0;i<6;i++){
			tf.turnEndDamageR[i] = Rdamage[i] + RdamageP[i];
			tf.turnEndDamageL[i] = Ldamage[i] + LdamageP[i];

			tf.turnEndRecoveryR[i] = Rrecovery[i];
			tf.turnEndRecoveryL[i] = Lrecovery[i];
			var SkillValue = searchSkill(i,'‹‘å‘Ì‹ë','right');
			if(SkillValue[0] == 1){
				if(SkillValue[1] > 80){SkillValue[1] = 80;}
				tf.turnEndDamageR[i]   = (int)(tf.turnEndDamageR[i]   * ((100 - SkillValue[1]) /100));
				tf.turnEndRecoveryR[i] = (int)(tf.turnEndRecoveryR[i] * ((100 - SkillValue[1]) /100));
			}
			var SkillValue = searchSkill(i,'‹‘å‘Ì‹ë','left');
			if(SkillValue[0] == 1){
				if(SkillValue[1] > 80){SkillValue[1] = 80;}
				tf.turnEndDamageL[i]   = (int)(tf.turnEndDamageL[i]   * ((100 - SkillValue[1]) /100));
				tf.turnEndRecoveryL[i] = (int)(tf.turnEndRecoveryL[i] * ((100 - SkillValue[1]) /100));
			}

			if(tf.rightParty[i].id !=0){
				dm("---"+tf.rightParty[i].unitName+"---");
				dm("‘Îp="+Rdamage[i]);
				dm("‘Î“Å="+RdamageP[i]);
				dm("‘‡="+tf.turnEndDamageR[i]);
				dm("‰ñ•œ="+tf.turnEndRecoveryR[i]);
			}
			if(tf.leftParty[i].id !=0){
				dm("---"+tf.leftParty[i].unitName+"---");
				dm("‘Îp="+Ldamage[i]);
				dm("‘Î“Å="+LdamageP[i]);
				dm("‘‡="+tf.turnEndDamageL[i]);
				dm("‰ñ•œ="+tf.turnEndRecoveryL[i]);
			}

			//’nŒ`UŒ‚
			tf.fortAttackR[i] = LfortAttack[i];
			tf.fortAttackL[i] = RfortAttack[i];
			tf.fortRepairR[i] = RfortRepair[i];
			tf.fortRepairL[i] = LfortRepair[i];
		}
	}

	//é•Çİ’è
	function setLandVitality(){
		//ƒXƒLƒ‹ƒ`ƒFƒbƒN
		tf.LandR.•ö‚µ’l=0;tf.LandL.•ö‚µ’l=0;
		tf.LandR.\’z’l=0;tf.LandL.\’z’l=0;
		tf.LandR.•ö‚µ  =0;tf.LandL.•ö‚µ  =0;
		tf.LandR.\’z  =0;tf.LandL.\’z  =0;
		for(var i=0;i<6;i++){
			//right
			if(tf.rightParty[i].id != 0 && tf.rightParty[i].HP.now > 0){
				//ƒXƒLƒ‹‘ÎÛ’nŒ`(‰E)
				var SkillValue = searchSkill(i,'é•Ç•ö‚µ','right');if(SkillValue[0] == 1){tf.LandR.•ö‚µ = 1;tf.LandR.•ö‚µ’l += SkillValue[1];}
				var SkillValue = searchSkill(i,'é•Ç\’z','right');if(SkillValue[0] == 1){tf.LandR.\’z = 1;tf.LandR.\’z’l += SkillValue[1];}
			}
			if(tf.leftParty[i].id != 0 && tf.leftParty[i].HP.now > 0){
				//ƒXƒLƒ‹‘ÎÛ’nŒ`(¶)
				var SkillValue = searchSkill(i,'é•Ç•ö‚µ','left');if(SkillValue[0] == 1){tf.LandL.•ö‚µ = 1;tf.LandL.•ö‚µ’l += SkillValue[1];}
				var SkillValue = searchSkill(i,'é•Ç\’z','left');if(SkillValue[0] == 1){tf.LandL.\’z = 1;tf.LandL.\’z’l += SkillValue[1];}
			}
		}

		//Œš•¨‘Ï‹v’l‘ã“ü
		if(gf.map[tf.EncountM[tf.BattleField]].frag == 0){
			tf.landBuildMaxR = gf.map[tf.EncountM[tf.BattleField]].HP.max;
			tf.landBuildNowR = gf.map[tf.EncountM[tf.BattleField]].HP.now;
			tf.landBuildMaxL = 0;
			tf.landBuildNowL = 0;
		}else{
			tf.landBuildMaxL = gf.map[tf.EncountM[tf.BattleField]].HP.max;
			tf.landBuildNowL = gf.map[tf.EncountM[tf.BattleField]].HP.now;
			tf.landBuildMaxR = 0;
			tf.landBuildNowR = 0;
		}

		//’nŒ`’l‚É‘ã“ü
		tf.rightLndM= f.used.stat.Land[0] + f.used.stat.Lands[0] + tf.landBuildMaxR;
		tf.rightLnd = f.used.stat.Land[0] + f.used.stat.Lands[0] + tf.landBuildNowR;
		tf.leftLndM = tf.landBaceMaxL     + tf.landBuildMaxL;
		tf.leftLnd  = tf.landBaceNowL     + tf.landBuildNowL;

		//ƒXƒLƒ‹•â³
		if(tf.LandR.\’z == 1){
			tf.rightLndM += tf.LandR.\’z’l;
			tf.rightLnd  += tf.LandR.\’z’l;
		}
		if(tf.LandR.•ö‚µ == 1){
			tf.leftLnd   -= tf.LandR.•ö‚µ’l;
		}
		if(tf.LandL.\’z == 1){
			tf.leftLndM  += tf.LandL.\’z’l;
			tf.leftLnd   += tf.LandL.\’z’l;
		}
		if(tf.LandL.•ö‚µ == 1){
			tf.rightLnd  -= tf.LandL.•ö‚µ’l;
		}
		if(tf.leftLnd  < 0){tf.leftLnd  = 0;}
		if(tf.rightLnd < 0){tf.rightLnd = 0;}
dm("tf.LandR.\’z’l:"+tf.LandR.\’z’l);
dm("tf.LandR.•ö‚µ’l:"+tf.LandR.•ö‚µ’l);
dm("tf.LandL.\’z’l:"+tf.LandL.\’z’l);
dm("tf.LandL.•ö‚µ’l:"+tf.LandL.•ö‚µ’l);
	}

}
